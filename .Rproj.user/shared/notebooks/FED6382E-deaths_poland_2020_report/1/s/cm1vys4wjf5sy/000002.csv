"0","# Function to extract general data from xlsx file."
"0","data_cleaning_ogolem <- function(tbl) {"
"0","  tbl %>%"
"0","    rename(age = ""...1"", code = ""...2"", name = ""...3"") %>%"
"0","    filter(str_detect(code, pattern = ""^PL[0-9][0-9]$""), age == ""Ogółem"") %>%"
"0","    mutate(name = str_to_lower(name)) %>%"
"0","    select(-age, -code) -> tb_1_step"
"0","  mazowiecki <- tb_1_step %>%"
"0","    filter(name %in% c(""warszawski stołeczny"", ""mazowiecki regionalny"")) %>%"
"0","    "
"0","    add_row(name = ""mazowieckie"","
"0","            tb_1_step %>%"
"0","              filter(name %in% c("
"0","                ""warszawski stołeczny"", ""mazowiecki regionalny"""
"0","              )) %>%"
"0","              select(-name) %>% summarise_all(sum)) %>%"
"0","    filter(name == ""mazowieckie"")"
"0","  tb_1_step %>%"
"0","    bind_rows(mazowiecki) %>%"
"0","    filter(str_detect(name, ""warszaw|regionalny"", negate = T)) %>%"
"0","    "
"0","    pivot_longer(cols = contains(""T""),"
"0","                 names_to = ""week"","
"0","                 values_to = ""deaths"")"
"0","}"
"0","# Function to extract age groups data  from xlsx file"
"0","data_cleaning_age <- function(tbl) {"
"0","  tbl %>% rename(age = ""...1"", code = ""...2"", name = ""...3"") %>%"
"0","    filter(str_detect(code, pattern = ""^PL[0-9][0-9]$""), age != ""Ogółem"") %>%"
"0","    mutate(name = str_to_lower(name)) %>%"
"0","    select(-code) %>%   pivot_longer(cols = contains(""T"") ,"
"0","                                     names_to = ""week"","
"0","                                     values_to = ""num_deaths"")"
"0","}"
